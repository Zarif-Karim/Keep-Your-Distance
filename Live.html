<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Live Camera</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content = "ie=edge"/>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" charset="utf-8"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.3.1/lib/p5.js"></script>
    <script src="https://unpkg.com/ml5@0.6.1/dist/ml5.min.js" type="text/javascript"></script>
    <script src="sketch.js"></script>
    <script src = "https://cdn.jsdelivr.net/npm/chart.js@3.2.1/dist/chart.min.js"></script>
    <style>
      h1{
        text-align: absolute;
      }
      .vidElement{
        border: black;
      }
      </style>
  </head>
  <body>
   <header>
    <div class="inner-width">
      <a href="homePages.html" class="logo"><img src="logo.png" alt=""></a>
      <i class="menu-toggle-btn fas fa-bars"></i>
     <nav class="navigation-menu">
      <a href="homePages.html"><i class="fas fa-home home"></i>HOME</a>
      <a href="Live.html"><i class="fas fa-users live"></i>LIVE CAMERA</a>
      <a href="Report.html"><i class="fas fa-headset report"></i>REPORT</a>
    </nav>
    </div>
  </header>
    <!-- live camera page--->
                  <h1>Live Camera</h1>
                      <div class = "introduction">
                          Accessing the camera<br>
                          is to detect the object and measurement distance<br>
                      </div>
                      <!--check box code--->
                    <div id="box3">
                      <div id="box4">
                        <div class="live-camera" style="margin-left: auto;">
                        <div id="canvas-container" width=640 height=480></div>
                        <video id="vid" autoplay style=" background-color: white;width: auto; height: auto; margin-left: 50px; border: 2px solid lightblue ;" hidden></video>
                        <div>
                          <button id="start-btn" onclick="start();" style="margin: 15px;"> Start</button>
                          <button id="stop-btn" onclick="stop();" style="margin: 15px;"> Stop</button>
                          <button style="margin: 15px;">Report display</button>
                        </div>
                        </div>
                        <!--Check box access-->
                        <div class="dropdown" style="float:left;">
                          <button class="dropbtn">Camera Quality</button>
                          <div class="dropdown-content" style="left:0;">
                          <a href="#">High Quality </a>
                          <a href="#">Medium Quality</a>
                          <a href="#">Low Quality</a>
                          </div>
                        </div>
                              <div class="dropdown" style=" margin-left: 10px;">
                                <button class="dropbtn">Access Data</button>
                                <div class="dropdown-content" style="left:0;">
                                <a href="#">Save Live Camera</a>
                                <a href="Report.html">Saved Data</a>
                                </div>                        </div>
                      </div>
                     <div id="box8">
                    <div id="line_top_x"></div>
                    <div><canvas id = "chart0" width="auto" height="100px"></canvas></div>
                    <div><canvas id = "chart" width="auto" height="100px"></canvas></div>
                    <div><canvas id = "chart2" width="auto" height="100px"></canvas></div>
                      </div>

                  <!-- nav function--->
    <script type="text/javascript">
      $(".menu-toggle-btn").click(function(){
        $(this).toggleClass("fa-times");
        $(".navigation-menu").toggleClass("active");
      });
    </script>

    <!---script for objects per frame graph--->
    <script src="graph.js"></script>

      <!---script for graph 2-->

        <script>
        const xlabels = [];
        const yDist = [];
        chartIt();
        async function chartIt() {
          await getData();
        const ctx = document.getElementById('chart').getContext('2d');
        const myChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: xlabels,
            datasets: [
            {
              label: 'Distance(m) in the cumulative time(s)',
              data: yDist,
              fill:false,
              backgroundColor: "rgba(255, 99, 132, 0.4)",
              borderColor: "rgba(255, 99, 132, 1)",
              borderCapStyle:'butt',
              borderDash:[],
              borderDashOffset: 0.0,
              borderJoinStyle:'miter',
              pointBorderColor:"rgba(255, 99, 132, 1)",
              pointBackgroundColor:"rgba(255, 99, 132, 1)",
              pointBorderWidth:1,
              pointRadius: 0,
              pointHoverRadius:5,
              pointHoverBackgroundColor:"rgba(255, 99, 132, 1)",
              pointHoverBorderColor: "rgbd(220,200,220,1)",
              pointHoverBorderWidth:2,
              pointHitRadius:10,
              lineTension: 0.1,

            }]
          },
          options: {
                responsive: true,
                plugins: {
                  title: {
                    display: true,
                    text: 'Chart of frame number of processing time(m)'
                  }
                },
              scales: {
                //x axis detail
                    x: {
                      display: true,
                      title: {
                        display: true,
                        text: 'Cumulative time (second)'
                      },
                      grid: {
                        display: false
                      }
                    },
                  //y axis detail
                    y:{
                      display: true,
                        title: {
                          display: true,
                          text: 'Distance (meter)'
                      },
                      ticks: {
                        min:0,
                        // Include a dollar sign in the ticks
                        callback: function(value, index, values) {
                          return value +'m';
                        }
                      },
                      grid: {
                        display: false
                      },
                    }
              }
            },

        });
        }
          async function getData(){
            const response = await fetch('live-camera.csv');
            const data = await response.text();
            const table = data.split('\n').slice(1);
            table.forEach(row =>
            {
              const columns = row.split(',');
              const Cultime = columns[2];
              xlabels.push(Cultime);
              const distance = columns[4];
               yDist.push(parseFloat(distance));
              //console.log(Cultime, distance);
            });

            }
        </script>


          <!----script for graph 2---->
            <script>
            const xAxis = [];
            const yFrame = [];
            chartIt();
            async function chartIt() {
              await getData();
            const ctx = document.getElementById('chart2').getContext('2d');
            const myChart = new Chart(ctx, {
              type: 'line',
              data: {
                labels: xAxis,
                datasets: [
                {
                  data: yFrame,
                  label: 'Frame number in processing time(s)',
                  fill:false,
                  backgroundColor: "rgba(255, 99, 132, 0.4)",
                  borderColor: "rgba(255, 99, 132, 1)",
                  borderCapStyle:'butt',
                  borderDash:[],
                  borderDashOffset: 0.0,
                  borderJoinStyle:'miter',
                  pointBorderColor:"rgba(255, 99, 132, 1)",
                  pointBackgroundColor:"rgba(255, 99, 132, 1)",
                  pointBorderWidth:1,
                  pointRadius: 0,
                  pointHoverRadius:5,
                  pointHoverBackgroundColor:"rgba(255, 99, 132, 1)",
                  pointHoverBorderColor: "rgbd(220,200,220,1)",
                  pointHoverBorderWidth:2,
                  pointHitRadius:10,
                  lineTension: 0.1,

                }]
              },
              options: {
                    responsive: true,
                    plugins: {
                      title: {
                        display: true,
                        text: 'Chart with frame number in processing time (m)'
                      }
                    },
                  scales: {
                    //x axis detail
                        x: {
                          display: true,
                          title: {
                            display: true,
                            text: 'Processing time'
                          },
                          grid: {
                            display: false
                          }
                        },
                      //y axis detail
                        y:{
                          display: true,
                            title: {
                              display: true,
                              text: 'Distance'
                          },
                          ticks: {
                            min:0,
                            // Include a dollar sign in the ticks
                            callback: function(value, index, values) {
                              return value +'m';
                            }
                          },
                          grid: {
                            display: false
                          }
                        }
                  }
                  },
            });
            }

              async function getData(){
                const response = await fetch('live-camera.csv');
                const data = await response.text();


                const table = data.split('\n').slice(2);
                table.forEach(row =>
                {
                  const columns = row.split(',');
                  const FrameNo = columns[0];
                  xAxis.push(FrameNo);
                  const ProcessTime = columns[1];
                   yFrame.push(parseFloat(ProcessTime));
                  //console.log(FrameNo, ProcessTime);
                });

                }
            </script>


      </body>
